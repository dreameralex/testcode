# 网络知识

## 代理

### 代理服务器

代理的工作原理是：由代理服务器自己去访问你的目标网站，并加载它的内容，然后再把这些加载过的内容传递到你的窗口上。这样就相当于你在浏览目标网站了。因此代理经常被叫做“梯子”或者“桥”。使用代理的好处是，你不需要直接链接到目标网站，因此目标网站就无法获取你的IP地址，取而代之获取的是代理服务器的IP地址。这样你就可以隐藏你的位置信息了。 当你访问大多数代理服务的时候，他们通常会要求你选择一个代理服务器所在的国家。你可以通过对应国家的代理服务器访问目标网站，这样目标网站就会认为你是在对应国家进行访问的。 比如，如果你想要访问的网站屏蔽了你所在的国家，那么你可以用代理服务器换上其他国家的IP，只要代理服务器所在的位置不在屏蔽范围之内，你就可以通过代理服务器实现访问了

### 正向代理

正向代理: 顺着请求的方向进行的代理，即代理服务器它是由你配置为你服务，去请求目标服务器地址。

正向代理的作用:

1. 访问原来无法访问的资源，如google

2. 可以做缓存，加速访问资源

3. 对客户端访问授权，上网进行认证

4. 代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息

### 逆向代理

反向代理: 跟正向代理相反,它是为目标服务器进行服务的,但是请求的流程还是: clieng -> proxy -> server。

反向代理的作用:  

1. 保证内网的安全，阻止web攻击，大型网站，通常将反向代理作为公网访问地址，Web服务器是内网。

2. 负载均衡，通过反向代理服务器来优化网站的负载。

正向代理即是客户端代理, 代理客户端, 服务端不知道实际发起请求的客户端.

反向代理即是服务端代理, 代理服务端, 客户端不知道实际提供服务的服务端.

## Web服务基础

### DNS

DNS系统的作用

正向解析：根据主机名称（域名）查找对应的IP地址

反向解析：根据IP地址查找对应的主机域名

- **DNS域名解析过程**

1，在浏览器中输入[http://pool.btc.com](http://pool.btc.com/)域名，操作系统会先检查自己本地的hosts文件是否有这个网址映射关系，如果有，就先调用这个IP地址映射，完成域名解析。

2，如果hosts里没有这个域名的映射，则查找**本地DNS解析器缓存**，是否有这个网址映射关系，如果有，直接返回，完成域名解析。

3，如果hosts与本地DNS解析器缓存都没有相应的网址映射关系，首先会找TCP/ip参数中设置的首选DNS服务器，在此我们叫它**本地DNS服务器**，此服务器收到查询时，如果要查询的域名，包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析，此解析具有权威性。

4，如果要查询的域名，不在本地DNS服务器区域解析，但该服务器已缓存了此网址映射关系，则调用这个IP地址映射，完成域名解析，此解析不具有权威性。

5，如果本地DNS服务器本地区域文件与缓存解析都失效，则根据本地DNS服务器的设置（是否设置转发器）进行查询，如果未用转发模式，本地DNS就把请求发至13台根DNS，根DNS服务器收到请求后会判断这个域名(.com)是谁来授权管理，并会返回一个负责该顶级域名服务器的一个IP。本地DNS服务器收到IP信息后，将会联系负责.com域的这台服务器。这台负责.com域的服务器收到请求后，如果自己无法解析，它就会找一个管理.com域的下一级DNS服务器地址([http://BTC.com](http://btc.com/))给本地DNS服务器。当本地DNS服务器收到这个地址后，就会找[http://pool.btc.com](http://pool.btc.com/)域服务器，重复上面的动作，进行查询，直至找到[http://pool.btc.com](http://pool.btc.com/)主机。

6，如果用的是转发模式，此DNS服务器就会把请求转发至上一级DNS服务器，由上一级服务器进行解析，上一级服务器如果不能解析，或找根DNS或把转请求转至上上级，以此循环。不管是本地DNS服务器用是是转发，还是根提示，最后都是把结果返回给本地DNS服务器，由此DNS服务器再返回给客户机。

- HTTP协议位于OSI模型中第7层应用层。

- HTTP协议的重要应用是WWW服务。

- 用户上网流程、DNS解析流程。

- DNS解析获取到IP后，建立TCP连接，然后发送HTTP请求的细节和服务器响应细节

- HTTP请求报文与HTTP响应报文知识。

- 到达HTTP服务后，请求后端集群节点的流程为Nginx→FastCGI→PHP→（数据库、存储等）。

## HTTP 资源

### URL介绍

URI，全称为Uniform Resource Identifier，中文翻译为统一资源标识符，是一个用于标识某一互联网资源名称的字符串。这个字符串在世界范围内唯一标识并定位某一个信息资源。互联网上每个可用的数据资源（如HTML、图片、视频等）皆通过统一资源标识符进行定位。

### 静态网页资源

在网站设计中，纯粹HTML格式的网页（可以包含图片、视频、JS（前端功能实现）、CSS（样式）等）通常被称为“静态网页”，早期（大约2000年左右）的网站大多都是由静态网页制作的。静态网页是相对于动态网页而言的，是指没有后台数据库、不含程序（如PHP、JSP、ASP）、不可交互的网页。

静态网页资源的特点是，开发者编写的是什么，它显示的就是什么，一旦编写完成，就不会有任何改变。静态网页的维护和更新相对比较麻烦，每个不同的网页都需要单独编辑更新，静态网页一般适用于更新较少的宣传展示型网站。

静态网页资源有几个重要的特征：

- 每个页面都有一个固定的URL地址，且URL一般以.htm、.html、.shtml等常见形式为后缀，而且地址中不含有问号“？”或“&”等特殊符号。

- 网页内容一经发布到网站服务器上，无论是否有用户访问，每个网页的内容都是保存在网站服务器文件系统上的，也就是说，静态网页是实实在在保存在服务器上的文件实体，每个网页都是一个独立的文件。

- 网页内容是固定不变的，因此，容易被搜索引擎收录（容易被用户找到）（优点）。

- 因为网页没有数据库的支持，所以在网站制作和维护方面的工作量较大，当网站信息量很大时，完全依靠静态网页比较困难（缺点）。

- 网页的交互性较差，在程序的功能实现方面有较大的限制（缺点）。

- 网页程序在用户浏览器端解析，如IE浏览器，程序解析效率很高，由于服务器端不进行解析，并且不需要读取数据库，因此服务器端可以接受更多的并发访问。当客户端向服务器请求数据时，服务器会直接从磁盘文件系统上返回数据（不做任何解析），待客户端拿到数据后，在浏览器端解析并展现出来（优点 ）。

# 

# 网络设置

## ifconfig

ifconfig命令用于配置及显示网络接口、子网掩码等细节信息。它通常位于/sbin/ifconfig中。

### 设置网络接口的IP地址

```shell
ifconfig wlan0 192.168.0.80
ifconfig wlan0 192.168.0.80 netmask 255.255.252.0
```

### 打印网络接口列表

```shell
ifconfig | cut -c-10 | tr -d ' ' | tr -s '\n'
```

ifconfig输出的每行前10个字符被保留用于网络接口名称。因此我们用cut命令提取每一行的

前10个字符。tr -d ' '删除每一行的所有空格。用tr -s 'n'压缩多个换行符以生成接口名称列表。

### 显示IP地址

```shell
ifconfig iface_name


HWaddr 00:1c:bf:87:25:d2是硬件地址（MAC地址）
inet addr:192.168.0.82是IP地址；
Bcast:192.168.3.255是广播地址；
Mask:255.255.252.0是子网掩码。
```

提取IP地址：

egrep -o "inetaddr:[^ ]*" 会打印出inet addr:192.168.0.82。其中的模式以inetaddr:

作为起始，以非空格字符序列（由 [^ ]* 指定）作为结束。接下来命令grep -o "[0-9.]*"

只输出数字与点号（.）的组合，也就是IP地址。

```shell
 ifconfig wlan0 | egrep -o "inetaddr:[^ ]*" | grep -o "[0-9.]*"
```

### 硬件地址（MAC地址）欺骗

        MAC地址欺骗（或MAC地址盗用）通常用于突破基于MAC地址的局域网访问控制，例如在交换机上限定只转发源MAC地址修改为某个存在于访问列表中的MAC地址即可突破该访问限制，而且这种修改是动态的并且容易恢复。还有的访问控制方法将IP地址和MAC进行绑定，目的是使得一个交换机端口只能提供给一位用户的一台主机使用，此时攻击者需要同时修改自己的IP地址和MAC地址去突破这种限制。

　　在不同的操作系统中修改MAC地址有不同的方法，其实质都是网卡驱动程序从系统中读取地址信息并写入网卡的硬件存储器，而不是实际修改网卡硬件ROM中存储的原有地址，因此攻击者可以为了实施攻击临时修改主机的MAC地址，事后很容易恢复为原来的MAC地址。

```shell
ifconfig eth0 hw ether 00:1c:bf:87:25:d5
```

### 名字服务器与DNS（域名服务）

将IP地址映射为符号名称的这种技术称为域名服务（DNS）。名字服务器是在文件 /etc/resolv.conf中定义的。我们可以编辑该文件来手动添加名字服务器或是使用下面的命令。

```shell
sudo echo nameserver IP_ADDRESS >> /etc/resolv.conf
```

获取域名所对应IP地址的最简单方法就是用ping命令访问指定的域名:

```shell
ping google.com
```

### DNS查找

```shell
host google.com
nslookup google.com
```

也可以通过向文件/etc/hosts中加入条目来实现名字解析

```shell
 echo IP_ADDRESS symbolic_name >> /etc/hosts
 echo 192.168.0.9 backupserver >> /etc/hosts
```

### 显示路由表信息

操作系统维护着一个叫作路由表的表格，它包含了分组如何转发的信息。

```shell
route

route -n
```

# Ping

ping命令使用Internet控制消息协议（Internet Control Message Protocol，ICMP）中的echo分组检验网络上两台主机之间的连通性。当向某台主机发送echo分组时，如果分组能够送达且该主机处于活动状态，那么它就会返回一条回应（reply）。如果没有通往目标主机的路由或是目标主机不知道如何将回应返回给请求方，ping命令则执行失败

```shell
ping ADDRESS
```

# 跟踪IP路由

当应用程序通过Internet请求服务时，服务器可能位于远端，两者之间通过多个网关或路由器相连。traceroute命令可以显示分组途径的所有网关的地址。这些信息可以帮助我们搞明白分组到达目的地需要经过多少跳。中途的网关或路由器的数量给出了网络上两个节点之间的有效距离，这未必和物理距离有关。传输时间会随着每一跳增加。对于路由器而言，接收、解析以及发

送分组都是需要花时间的。
